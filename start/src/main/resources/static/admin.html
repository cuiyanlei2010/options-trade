<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>期权工具 - 系统管理</title>
    <link rel="stylesheet" href="layui/css/layui.css">
    <style>
        .layui-card {
            margin-bottom: 15px;
        }
        .layui-card-header {
            font-weight: bold;
        }
        .layui-form-item {
            margin-bottom: 10px;
        }
        .layui-btn-group {
            margin-bottom: 10px;
        }
        .layui-table-tool {
            padding: 5px 10px;
        }
        .layui-tab-content {
            padding: 15px 0;
        }
    </style>
</head>
<body>
    <div class="layui-layout layui-layout-admin">
        <div class="layui-header">
            <div class="layui-logo layui-hide-xs layui-bg-black">Options</div>
            <ul class="layui-nav layui-layout-left">
                <li class="layui-nav-item"><a href="analyze.html">标的分析</a></li>
                <li class="layui-nav-item"><a href="order.html">策略订单</a></li>
                <li class="layui-nav-item"><a href="summary.html">账户汇总</a></li>
                <li class="layui-nav-item"><a href="assistant.html">AI 助手</a></li>
                <li class="layui-nav-item"><a href="sync.html">同步订单</a></li>
                <li class="layui-nav-item layui-this"><a href="admin.html">后台管理</a></li>
            </ul>
        </div>

        <div class="layui-body" style="left: 0;">
            <div style="padding: 15px;">
                <!-- Tab选项卡 -->
                <div class="layui-tab layui-tab-brief" lay-filter="adminTab">
                    <ul class="layui-tab-title">
                        <li class="layui-this">期权标的管理</li>
                        <li>期权策略管理</li>
                        <li>账户管理</li>
                        <li>知识库管理</li>
                    </ul>
                    <div class="layui-tab-content">
                        <!-- 期权标的管理 -->
                        <div class="layui-tab-item layui-show">
                            <div class="layui-card">
                                <div class="layui-card-header">期权标的管理</div>
                                <div class="layui-card-body">
                                    <div class="layui-btn-group">
                                        <button type="button" class="layui-btn layui-btn-sm" id="addSecurityBtn">
                                            <i class="layui-icon">&#xe654;</i> 添加标的
                                        </button>
                                        <button type="button" class="layui-btn layui-btn-sm layui-btn-danger" id="deleteSecurityBtn">
                                            <i class="layui-icon">&#xe640;</i> 删除
                                        </button>
                                        <button type="button" class="layui-btn layui-btn-sm layui-btn-normal" id="refreshSecurityBtn">
                                            <i class="layui-icon">&#xe669;</i> 刷新
                                        </button>
                                    </div>
                                    <table id="securityTable" lay-filter="securityTable"></table>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 期权策略管理 -->
                        <div class="layui-tab-item">
                            <div class="layui-card">
                                <div class="layui-card-header">期权策略管理</div>
                                <div class="layui-card-body">
                                    <div class="layui-btn-group">
                                        <button type="button" class="layui-btn layui-btn-sm" id="addStrategyBtn">
                                            <i class="layui-icon">&#xe654;</i> 添加策略
                                        </button>
                                        <button type="button" class="layui-btn layui-btn-sm layui-btn-danger" id="deleteStrategyBtn">
                                            <i class="layui-icon">&#xe640;</i> 删除
                                        </button>
                                        <button type="button" class="layui-btn layui-btn-sm layui-btn-normal" id="refreshStrategyBtn">
                                            <i class="layui-icon">&#xe669;</i> 刷新
                                        </button>
                                    </div>
                                    <table id="strategyTable" lay-filter="strategyTable"></table>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 账户管理 -->
                        <div class="layui-tab-item">
                            <div class="layui-card">
                                <div class="layui-card-header">账户管理</div>
                                <div class="layui-card-body">
                                    <div class="layui-btn-group">
                                        <button type="button" class="layui-btn layui-btn-sm" id="addAccountBtn">
                                            <i class="layui-icon">&#xe654;</i> 添加账户
                                        </button>
                                        <button type="button" class="layui-btn layui-btn-sm layui-btn-danger" id="deleteAccountBtn">
                                            <i class="layui-icon">&#xe640;</i> 删除
                                        </button>
                                        <button type="button" class="layui-btn layui-btn-sm layui-btn-normal" id="refreshAccountBtn">
                                            <i class="layui-icon">&#xe669;</i> 刷新
                                        </button>
                                    </div>
                                    <table id="accountTable" lay-filter="accountTable"></table>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 知识库管理 -->
                        <div class="layui-tab-item">
                            <div class="layui-card">
                                <div class="layui-card-header">知识库管理</div>
                                <div class="layui-card-body">
                                    <div class="layui-btn-group">
                                        <button type="button" class="layui-btn layui-btn-sm" id="addKnowledgeBtn">
                                            <i class="layui-icon">&#xe654;</i> 添加知识
                                        </button>
                                        <button type="button" class="layui-btn layui-btn-sm layui-btn-danger" id="deleteKnowledgeBtn">
                                            <i class="layui-icon">&#xe640;</i> 删除
                                        </button>
                                        <button type="button" class="layui-btn layui-btn-sm layui-btn-normal" id="refreshKnowledgeBtn">
                                            <i class="layui-icon">&#xe669;</i> 刷新
                                        </button>
                                    </div>
                                    <table id="knowledgeTable" lay-filter="knowledgeTable"></table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 期权标的表格操作按钮 -->
    <script type="text/html" id="securityTableBar">
        <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
        <a class="layui-btn layui-btn-xs layui-btn-danger" lay-event="delete">删除</a>
        <a class="layui-btn layui-btn-xs layui-btn-normal" lay-event="toggle">{{d.status === 1 ? '禁用' : '启用'}}</a>
    </script>

    <!-- 期权策略表格操作按钮 -->
    <script type="text/html" id="strategyTableBar">
        <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
        <a class="layui-btn layui-btn-xs layui-btn-danger" lay-event="delete">删除</a>
        <a class="layui-btn layui-btn-xs layui-btn-normal" lay-event="toggle">{{d.status === 1 ? '禁用' : '启用'}}</a>
    </script>

    <!-- 账户表格操作按钮 -->
    <script type="text/html" id="accountTableBar">
        <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
        <a class="layui-btn layui-btn-xs layui-btn-danger" lay-event="delete">删除</a>
    </script>
    
    <!-- 知识库表格操作按钮 -->
    <script type="text/html" id="knowledgeTableBar">
        <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
        <a class="layui-btn layui-btn-xs layui-btn-danger" lay-event="delete">删除</a>
        <a class="layui-btn layui-btn-xs layui-btn-normal" lay-event="toggle">{{d.status === 1 ? '禁用' : '启用'}}</a>
    </script>

    <!-- 期权标的编辑表单 -->
    <script type="text/html" id="securityFormTpl">
        <form class="layui-form" id="securityForm" lay-filter="securityForm" style="padding: 20px;">
            <input type="hidden" name="id">
            <div class="layui-form-item">
                <label class="layui-form-label">标的名称</label>
                <div class="layui-input-block">
                    <input type="text" name="name" required lay-verify="required" placeholder="请输入标的名称" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">标的代码</label>
                <div class="layui-input-block">
                    <input type="text" name="code" required lay-verify="required" placeholder="请输入标的代码" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">市场</label>
                <div class="layui-input-block">
                    <input type="number" name="market" required lay-verify="required" placeholder="请输入市场代码" autocomplete="off" class="layui-input" value="11">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">状态</label>
                <div class="layui-input-block">
                    <input type="radio" name="status" value="1" title="启用" checked>
                    <input type="radio" name="status" value="0" title="禁用">
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-block">
                    <button class="layui-btn" lay-submit lay-filter="securitySubmit">立即提交</button>
                    <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                </div>
            </div>
        </form>
            </script>

            <!-- 知识库编辑表单 -->
            <script type="text/html" id="knowledgeFormTpl">
                <form class="layui-form" id="knowledgeForm" lay-filter="knowledgeForm" style="padding: 20px;">
                    <input type="hidden" name="id">
                    <div class="layui-form-item">
                        <label class="layui-form-label">标题</label>
                        <div class="layui-input-block">
                            <input type="text" name="title" required lay-verify="required" placeholder="请输入标题" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">类型</label>
                        <div class="layui-input-block">
                            <select name="type" lay-verify="required">
                                <option value="">请选择类型</option>
                                <option value="1">期权策略知识</option>
                                <option value="2">规则知识</option>
                            </select>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">描述</label>
                        <div class="layui-input-block">
                            <input type="text" name="description" placeholder="请输入描述" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">内容</label>
                        <div class="layui-input-block">
                            <textarea name="content" placeholder="请输入内容（支持Markdown）" class="layui-textarea" style="height: 200px;"></textarea>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">状态</label>
                        <div class="layui-input-block">
                            <input type="radio" name="status" value="1" title="启用" checked>
                            <input type="radio" name="status" value="0" title="禁用">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <button class="layui-btn" lay-submit lay-filter="knowledgeSubmit">立即提交</button>
                            <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                        </div>
                    </div>
                </form>
            </script>

            <!-- 期权策略编辑表单 -->
            <script type="text/html" id="strategyFormTpl">
        <form class="layui-form" id="strategyForm" lay-filter="strategyForm" style="padding: 20px;">
            <input type="hidden" name="id">
            <input type="hidden" name="ext" value="{}">
            <div class="layui-form-item">
                <label class="layui-form-label">策略ID</label>
                <div class="layui-input-block">
                    <input type="text" name="strategyId" placeholder="自动生成，可留空" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">策略名称</label>
                <div class="layui-input-block">
                    <input type="text" name="strategyName" required lay-verify="required" placeholder="请输入策略名称" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">策略代码</label>
                <div class="layui-input-block">
                    <select name="strategyCode" lay-verify="required" lay-filter="strategyCode">
                        <option value="">请选择策略代码</option>
                        <option value="default">默认策略</option>
                        <option value="wheel_strategy">车轮策略</option>
                        <option value="cc_strategy">CC策略</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">策略阶段</label>
                <div class="layui-input-block">
                    <select name="stage" lay-verify="required">
                        <option value="">请选择策略阶段</option>
                        <option value="running">运行中</option>
                        <option value="suspend">暂停</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">标的代码</label>
                <div class="layui-input-block">
                    <select name="code" lay-verify="required" id="securitySelect" lay-filter="securitySelect">
                        <option value="">请选择标的代码</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">合约股数</label>
                <div class="layui-input-block">
                    <input type="number" name="lotSize" required lay-verify="required" placeholder="请输入每份合约股票数" autocomplete="off" class="layui-input" value="100">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">初始股票数</label>
                <div class="layui-input-block">
                    <input type="number" name="initialStockNum" placeholder="请输入策略初始股票数量" autocomplete="off" class="layui-input" value="0">
                    <div class="layui-form-mid layui-word-aux">如果已持有股票，请输入持有数量，默认为0</div>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">初始成本价</label>
                <div class="layui-input-block">
                    <input type="number" name="initialStockCost" placeholder="请输入初始股票成本价" autocomplete="off" class="layui-input" value="">
                    <div class="layui-form-mid layui-word-aux">已持有股票的平均成本价，用于计算盈亏</div>
                </div>
            </div>
            <div class="layui-form-item" id="wheelStrategyConfig" style="display: none;">
                <label class="layui-form-label">Sell Put行权价</label>
                <div class="layui-input-block">
                    <input type="text" name="sellPutStrikePrice" placeholder="请输入Sell Put可接受的最低行权价" autocomplete="off" class="layui-input">
                    <div class="layui-form-mid layui-word-aux">配置后，低于此行权价的Put期权将不会被推荐</div>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">状态</label>
                <div class="layui-input-block">
                    <input type="radio" name="status" value="1" title="启用" checked>
                    <input type="radio" name="status" value="0" title="禁用">
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-block">
                    <button class="layui-btn" lay-submit lay-filter="strategySubmit">立即提交</button>
                    <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                </div>
            </div>
        </form>
    </script>

    <!-- 账户编辑表单 -->
    <script type="text/html" id="accountFormTpl">
        <form class="layui-form" id="accountForm" lay-filter="accountForm" style="padding: 20px;">
            <input type="hidden" name="id">
            <div class="layui-form-item">
                <label class="layui-form-label">平台</label>
                <div class="layui-input-block">
                    <select name="platform" lay-verify="required" lay-filter="platform">
                        <option value="">请选择平台</option>
                        <option value="futu">富途</option>
                        <option value="longport">长桥</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">市场</label>
                <div class="layui-input-block">
                    <input type="number" name="market" required lay-verify="required" placeholder="请输入市场代码" autocomplete="off" class="layui-input" value="11">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">账号</label>
                <div class="layui-input-block">
                    <input type="text" name="accountId" required lay-verify="required" placeholder="请输入账号" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">OTP认证</label>
                <div class="layui-input-block">
                    <input type="text" name="otpAuth" placeholder="请输入OTP认证信息" autocomplete="off" class="layui-input">
                </div>
            </div>

            <!-- 扩展字段配置 -->
            <div id="accountExtFields">
                <!-- 动态渲染的扩展字段将在这里显示 -->
            </div>
            
            <div class="layui-form-item">
                <div class="layui-input-block">
                    <button class="layui-btn" lay-submit lay-filter="accountSubmit">立即提交</button>
                    <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                </div>
            </div>
        </form>
    </script>

    <script src="layui/layui.js"></script>
    <script src="common.js"></script>
    <script src="admin.js"></script>
</body>
</html>